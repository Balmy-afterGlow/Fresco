# Fresco æ°´æœè”¬èœåˆ†ç±»ç³»ç»Ÿ - è¯¦å°½è®¾è®¡æ–‡æ¡£

![Fresco Logo](https://img.shields.io/badge/Fresco-Fruit%20%26%20Vegetable%20Classification-green?style=for-the-badge)

---

## ğŸ“‹ ç›®å½•

- [1. é¡¹ç›®èƒŒæ™¯ä¸ç›®æ ‡](#1-é¡¹ç›®èƒŒæ™¯ä¸ç›®æ ‡)
- [2. ç³»ç»Ÿæ•´ä½“æ¶æ„](#2-ç³»ç»Ÿæ•´ä½“æ¶æ„)
- [3. æŠ€æœ¯æ ˆé€‰å‹ä¸å†³ç­–](#3-æŠ€æœ¯æ ˆé€‰å‹ä¸å†³ç­–)
- [4. æ ¸å¿ƒåŠŸèƒ½æ¨¡å—è®¾è®¡](#4-æ ¸å¿ƒåŠŸèƒ½æ¨¡å—è®¾è®¡)
- [5. åˆ›æ–°ç‚¹ä¸æŠ€æœ¯äº®ç‚¹](#5-åˆ›æ–°ç‚¹ä¸æŠ€æœ¯äº®ç‚¹)
- [6. æ•°æ®æµä¸å¤„ç†æµç¨‹](#6-æ•°æ®æµä¸å¤„ç†æµç¨‹)
- [7. æ¨¡å‹æ¶æ„è®¾è®¡](#7-æ¨¡å‹æ¶æ„è®¾è®¡)
- [8. è®­ç»ƒç­–ç•¥ä¸ä¼˜åŒ–æ–¹æ¡ˆ](#8-è®­ç»ƒç­–ç•¥ä¸ä¼˜åŒ–æ–¹æ¡ˆ)
- [9. éƒ¨ç½²ä¸æœåŠ¡æ¶æ„](#9-éƒ¨ç½²ä¸æœåŠ¡æ¶æ„)
- [10. æ€§èƒ½åˆ†æä¸ä¼˜åŒ–](#10-æ€§èƒ½åˆ†æä¸ä¼˜åŒ–)
- [11. ç³»ç»Ÿæ‰©å±•æ€§è®¾è®¡](#11-ç³»ç»Ÿæ‰©å±•æ€§è®¾è®¡)
- [12. è´¨é‡ä¿è¯ä¸æµ‹è¯•](#12-è´¨é‡ä¿è¯ä¸æµ‹è¯•)

---

## 1. é¡¹ç›®èƒŒæ™¯ä¸ç›®æ ‡

### 1.1 èƒŒæ™¯ä»‹ç»

éšç€æ™ºèƒ½å†œä¸šã€æ–°é›¶å”®å’Œé£Ÿå“å®‰å…¨éœ€æ±‚çš„å¿«é€Ÿå‘å±•ï¼Œè‡ªåŠ¨åŒ–æ°´æœè”¬èœè¯†åˆ«æŠ€æœ¯åœ¨å¤šä¸ªé¢†åŸŸå±•ç°å‡ºå·¨å¤§çš„åº”ç”¨ä»·å€¼ï¼š

- **æ™ºèƒ½å†œä¸š**ï¼šè‡ªåŠ¨åŒ–åˆ†æ‹£ã€å“è´¨æ£€æµ‹ã€äº§é‡ä¼°ç®—
- **æ–°é›¶å”®**ï¼šæ— äººè¶…å¸‚è‡ªåŠ©ç»“ç®—ã€æ™ºèƒ½ç§°é‡
- **é£Ÿå“å®‰å…¨**ï¼šé£Ÿå“æº¯æºã€å“è´¨ç›‘æ§ã€è¥å…»åˆ†æ
- **æ•™è‚²ç§‘ç ”**ï¼šå†œä¸šæ•™å­¦ã€ç”Ÿç‰©è¯†åˆ«ç ”ç©¶

### 1.2 é¡¹ç›®ç›®æ ‡

**æ ¸å¿ƒç›®æ ‡**ï¼šæ„å»ºä¸€ä¸ªé«˜ç²¾åº¦ã€é«˜æ•ˆç‡ã€æ˜“æ‰©å±•çš„ç«¯åˆ°ç«¯æ°´æœè”¬èœå›¾åƒåˆ†ç±»ç³»ç»Ÿ

**å…·ä½“æŒ‡æ ‡**ï¼š
- æ”¯æŒ 36 ç§å¸¸è§æ°´æœè”¬èœçš„ç²¾ç¡®è¯†åˆ«
- éªŒè¯é›†å‡†ç¡®ç‡ > 95%
- å•å¼ å›¾ç‰‡æ¨ç†æ—¶é—´ < 100ms
- æ”¯æŒæ‰¹é‡å¤„ç†å’Œå®æ—¶è¯†åˆ«
- æä¾›å‹å¥½çš„ Web äº¤äº’ç•Œé¢
- å…·å¤‡è‰¯å¥½çš„å¯æ‰©å±•æ€§å’Œéƒ¨ç½²ä¾¿åˆ©æ€§

### 1.3 åº”ç”¨åœºæ™¯

```mermaid
mindmap
  root((Fresco åº”ç”¨åœºæ™¯))
    æ™ºèƒ½å†œä¸š
      è‡ªåŠ¨åˆ†æ‹£ç³»ç»Ÿ
      å“è´¨æ£€æµ‹
      äº§é‡é¢„æµ‹
      ç—…è™«å®³è¯†åˆ«
    æ–°é›¶å”®
      è‡ªåŠ©ç»“ç®—
      æ™ºèƒ½ç§°é‡
      åº“å­˜ç®¡ç†
      æ¨èç³»ç»Ÿ
    é£Ÿå“å®‰å…¨
      é£Ÿå“æº¯æº
      å“è´¨ç›‘æ§
      è¥å…»åˆ†æ
      è¿‡æœŸæ£€æµ‹
    æ•™è‚²ç§‘ç ”
      å†œä¸šæ•™å­¦
      ç”Ÿç‰©è¯†åˆ«
      æ•°æ®é‡‡é›†
      ç®—æ³•ç ”ç©¶
```

---

## 2. ç³»ç»Ÿæ•´ä½“æ¶æ„

### 2.1 ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

```mermaid
graph TB
    subgraph "æ•°æ®å±‚"
        A1[åŸå§‹æ•°æ®é›†<br/>36ç±»æ°´æœè”¬èœ]
        A2[æ•°æ®é¢„å¤„ç†<br/>FruitVegDataset]
        A3[æ•°æ®å¢å¼º<br/>Transforms]
    end
    
    subgraph "è®­ç»ƒå±‚"
        B1[è¶…å‚æ•°é…ç½®<br/>HyperparameterConfig]
        B2[æ¨¡å‹æ¶æ„<br/>OptimizedCNN]
        B3[è®­ç»ƒå¼•æ“<br/>OptimizedTrainer]
        B4[ä¼˜åŒ–ç­–ç•¥<br/>EMA/æ—©åœ/è°ƒåº¦å™¨]
    end
    
    subgraph "æœåŠ¡å±‚"
        C1[æ¨¡å‹æ¨ç†<br/>predict_latest.py]
        C2[WebæœåŠ¡<br/>Flask App]
        C3[æ‰¹å¤„ç†æ¥å£<br/>Batch API]
    end
    
    subgraph "åº”ç”¨å±‚"
        D1[Webç•Œé¢<br/>HTML/CSS/JS]
        D2[APIæ¥å£<br/>RESTful]
        D3[å¯è§†åŒ–å·¥å…·<br/>matplotlib]
    end
    
    A1 --> A2
    A2 --> A3
    A3 --> B3
    B1 --> B3
    B2 --> B3
    B3 --> B4
    B3 --> C1
    C1 --> C2
    C1 --> C3
    C2 --> D1
    C2 --> D2
    B3 --> D3
    
    classDef dataLayer fill:#e1f5fe
    classDef trainLayer fill:#f3e5f5
    classDef serviceLayer fill:#e8f5e8
    classDef appLayer fill:#fff3e0
    
    class A1,A2,A3 dataLayer
    class B1,B2,B3,B4 trainLayer
    class C1,C2,C3 serviceLayer
    class D1,D2,D3 appLayer
```

### 2.2 æ ¸å¿ƒç»„ä»¶äº¤äº’

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant W as Webç•Œé¢
    participant A as Flask App
    participant M as æ¨¡å‹æ¨ç†
    participant D as æ•°æ®å¤„ç†
    
    U->>W: ä¸Šä¼ å›¾ç‰‡
    W->>A: HTTPè¯·æ±‚
    A->>D: å›¾ç‰‡é¢„å¤„ç†
    D->>M: æ ‡å‡†åŒ–å¼ é‡
    M->>M: æ¨¡å‹æ¨ç†
    M->>A: é¢„æµ‹ç»“æœ
    A->>W: JSONå“åº”
    W->>U: æ˜¾ç¤ºç»“æœ
```

---

## 3. æŠ€æœ¯æ ˆé€‰å‹ä¸å†³ç­–

### 3.1 æ·±åº¦å­¦ä¹ æ¡†æ¶é€‰æ‹©

| æ¡†æ¶ | ä¼˜åŠ¿ | åŠ£åŠ¿ | é€‰æ‹©ç†ç”± |
|------|------|------|----------|
| **PyTorch** âœ… | åŠ¨æ€å›¾ã€æ˜“è°ƒè¯•ã€ç”Ÿæ€ä¸°å¯Œ | éƒ¨ç½²å¤æ‚åº¦è¾ƒé«˜ | ç ”ç©¶å‹å¥½ï¼Œæ”¯æŒæ··åˆç²¾åº¦ï¼Œç¤¾åŒºæ´»è·ƒ |
| TensorFlow | é™æ€å›¾ä¼˜åŒ–ã€éƒ¨ç½²ä¾¿åˆ© | è°ƒè¯•å›°éš¾ã€å­¦ä¹ æ›²çº¿é™¡å³­ | - |
| PaddlePaddle | ä¸­æ–‡ç”Ÿæ€ã€äº§ä¸šåŒ– | ç”Ÿæ€ç›¸å¯¹è¾ƒå° | - |

### 3.2 æ¨¡å‹æ¶æ„é€‰æ‹©

```mermaid
graph LR
    subgraph "ä¸»å¹²ç½‘ç»œå¯¹æ¯”"
        A[ResNet50] --> A1[âœ… å¹³è¡¡æ€§èƒ½ä¸é€Ÿåº¦]
        B[EfficientNet] --> B1[âŒ æ¨ç†é€Ÿåº¦è¾ƒæ…¢]
        C[Vision Transformer] --> C1[âŒ æ•°æ®éœ€æ±‚é‡å¤§]
        D[MobileNet] --> D1[âŒ ç²¾åº¦ç›¸å¯¹è¾ƒä½]
    end
```

**é€‰æ‹© ResNet50 çš„åŸå› **ï¼š
- **æˆç†Ÿç¨³å®š**ï¼šç»è¿‡å¤§é‡å®è·µéªŒè¯ï¼ŒBugè¾ƒå°‘
- **é¢„è®­ç»ƒæƒé‡è´¨é‡é«˜**ï¼šImageNeté¢„è®­ç»ƒæ•ˆæœå‡ºè‰²
- **è®¡ç®—æ•ˆç‡é€‚ä¸­**ï¼šåœ¨ç²¾åº¦å’Œé€Ÿåº¦é—´å–å¾—è‰¯å¥½å¹³è¡¡
- **è¿ç§»å­¦ä¹ å‹å¥½**ï¼šé€‚åˆå°æ ·æœ¬åœºæ™¯çš„Fine-tuning

### 3.3 ä¼˜åŒ–ç­–ç•¥æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ä½œç”¨ | æ€§èƒ½æå‡ |
|------|------|------|----------|
| **æ··åˆç²¾åº¦è®­ç»ƒ** | torch.amp | é™ä½æ˜¾å­˜ã€åŠ é€Ÿè®­ç»ƒ | è®­ç»ƒé€Ÿåº¦æå‡30-50% |
| **æŒ‡æ•°ç§»åŠ¨å¹³å‡** | è‡ªå®ç°EMA | æå‡æ¨¡å‹æ³›åŒ–èƒ½åŠ› | éªŒè¯ç²¾åº¦æå‡1-2% |
| **å­¦ä¹ ç‡è°ƒåº¦** | OneCycleLR | å¿«é€Ÿæ”¶æ•›ã€é¿å…éœ‡è¡ | æ”¶æ•›é€Ÿåº¦æå‡20% |
| **æ¢¯åº¦è£å‰ª** | clip_grad_norm_ | é˜²æ­¢æ¢¯åº¦çˆ†ç‚¸ | è®­ç»ƒç¨³å®šæ€§æå‡ |
| **æ—©åœæœºåˆ¶** | è‡ªå®ç°EarlyStopping | é˜²æ­¢è¿‡æ‹Ÿåˆ | èŠ‚çœè®­ç»ƒæ—¶é—´30% |

---

## 4. æ ¸å¿ƒåŠŸèƒ½æ¨¡å—è®¾è®¡

### 4.1 æ•°æ®å¤„ç†æ¨¡å—

```mermaid
classDiagram
    class FruitVegDataset {
        +str root_dir
        +str split
        +transform
        +list classes
        +dict class_to_idx
        +list images
        +list labels
        +__init__(root_dir, split, transform)
        +__len__()
        +__getitem__(idx)
        +get_class_distribution()
    }
    
    class DataAugmentation {
        +RandomResizedCrop
        +RandomHorizontalFlip
        +RandomVerticalFlip
        +RandomRotation
        +ColorJitter
        +RandomErasing
        +GaussianBlur
        +get_train_transform()
        +get_val_transform()
    }
    
    FruitVegDataset --> DataAugmentation : uses
```

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- **è‡ªåŠ¨åŒ–æ ‡ç­¾ç”Ÿæˆ**ï¼šæ ¹æ®ç›®å½•ç»“æ„è‡ªåŠ¨åˆ†é…ç±»åˆ«æ ‡ç­¾
- **å¤šæ ·åŒ–æ•°æ®å¢å¼º**ï¼š15ç§å¢å¼ºç­–ç•¥ç»„åˆï¼Œæå‡æ¨¡å‹é²æ£’æ€§
- **å†…å­˜ä¼˜åŒ–**ï¼šå»¶è¿ŸåŠ è½½æœºåˆ¶ï¼Œé¿å…å†…å­˜æº¢å‡º
- **ç±»åˆ«å¹³è¡¡æ£€æµ‹**ï¼šè‡ªåŠ¨åˆ†ææ•°æ®åˆ†å¸ƒï¼Œè¯†åˆ«ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜

### 4.2 è¶…å‚æ•°ç®¡ç†æ¨¡å—

```python
@dataclass
class HyperparameterConfig:
    # æ•°æ®ç›¸å…³
    batch_size: int = 16
    num_workers: int = 4
    pin_memory: bool = True
    
    # ä¼˜åŒ–å™¨ç›¸å…³
    learning_rate: float = 1e-3
    weight_decay: float = 0.01
    betas: tuple = (0.9, 0.999)
    
    # è®­ç»ƒç­–ç•¥
    epochs: int = 60
    warmup_epochs: int = 5
    patience: int = 10
    
    # æ­£åˆ™åŒ–
    dropout: float = 0.3
    label_smoothing: float = 0.1
    
    # é«˜çº§ç‰¹æ€§
    use_amp: bool = True
    use_ema: bool = False
    gradient_clip_val: float = 1.0
```

**è®¾è®¡ä¼˜åŠ¿**ï¼š
- **ç±»å‹å®‰å…¨**ï¼šä½¿ç”¨dataclassç¡®ä¿å‚æ•°ç±»å‹æ­£ç¡®
- **æ–‡æ¡£åŒ–**ï¼šæ¯ä¸ªå‚æ•°éƒ½æœ‰æ˜ç¡®çš„æ³¨é‡Šè¯´æ˜
- **ç‰ˆæœ¬æ§åˆ¶å‹å¥½**ï¼šå‚æ•°å˜æ›´å¯è¿½è¸ª
- **å®éªŒå¤ç°**ï¼šç¡®ä¿å®éªŒçš„å¯é‡å¤æ€§

### 4.3 è®­ç»ƒå¼•æ“æ¨¡å—

```mermaid
graph TD
    subgraph "OptimizedTrainer æ ¸å¿ƒåŠŸèƒ½"
        A[è®­ç»ƒå¾ªç¯ç®¡ç†] --> A1[epochè®­ç»ƒ]
        A[è®­ç»ƒå¾ªç¯ç®¡ç†] --> A2[éªŒè¯è¯„ä¼°]
        A[è®­ç»ƒå¾ªç¯ç®¡ç†] --> A3[æ£€æŸ¥ç‚¹ä¿å­˜]
        
        B[ä¼˜åŒ–ç­–ç•¥é›†æˆ] --> B1[æ··åˆç²¾åº¦è®­ç»ƒ]
        B[ä¼˜åŒ–ç­–ç•¥é›†æˆ] --> B2[æ¢¯åº¦è£å‰ª]
        B[ä¼˜åŒ–ç­–ç•¥é›†æˆ] --> B3[å­¦ä¹ ç‡è°ƒåº¦]
        B[ä¼˜åŒ–ç­–ç•¥é›†æˆ] --> B4[æŒ‡æ•°ç§»åŠ¨å¹³å‡]
        
        C[ç›‘æ§ä¸å¯è§†åŒ–] --> C1[è®­ç»ƒå†å²è®°å½•]
        C[ç›‘æ§ä¸å¯è§†åŒ–] --> C2[å®æ—¶è¿›åº¦æ˜¾ç¤º]
        C[ç›‘æ§ä¸å¯è§†åŒ–] --> C3[æ€§èƒ½æŒ‡æ ‡è®¡ç®—]
        
        D[è‡ªåŠ¨åŒ–æœºåˆ¶] --> D1[æ—©åœæ£€æµ‹]
        D[è‡ªåŠ¨åŒ–æœºåˆ¶] --> D2[æœ€ä½³æ¨¡å‹ä¿å­˜]
        D[è‡ªåŠ¨åŒ–æœºåˆ¶] --> D3[å¼‚å¸¸å¤„ç†]
    end
```

### 4.4 æ¨¡å‹æ¶æ„æ¨¡å—

```mermaid
graph TB
    subgraph "OptimizedCNN æ¶æ„"
        A[ResNet50 Backbone<br/>é¢„è®­ç»ƒæƒé‡] --> B[å†»ç»“ç­–ç•¥<br/>70%å±‚å†»ç»“]
        B --> C[å…¨å±€å¹³å‡æ± åŒ–<br/>GAP]
        C --> D[åˆ†ç±»å¤´è®¾è®¡]
        
        subgraph "åˆ†ç±»å¤´è¯¦ç»†ç»“æ„"
            D --> D1[Linear: 2048â†’1024]
            D1 --> D2[LayerNorm + GELU]
            D2 --> D3[Dropout 0.4]
            D3 --> D4[AttentionLayer<br/>æ³¨æ„åŠ›æœºåˆ¶]
            D4 --> D5[Linear: 1024â†’512]
            D5 --> D6[LayerNorm + GELU]
            D6 --> D7[Dropout 0.3]
            D7 --> D8[Linear: 512â†’36<br/>è¾“å‡ºå±‚]
        end
    end
```

**åˆ›æ–°è®¾è®¡**ï¼š
- **æ¸è¿›å¼è§£å†»**ï¼šè®­ç»ƒè¿‡ç¨‹ä¸­é€æ­¥è§£å†»æ›´å¤šå±‚
- **æ³¨æ„åŠ›å¢å¼º**ï¼šè‡ªå®šä¹‰è½»é‡çº§æ³¨æ„åŠ›æœºåˆ¶
- **æ¿€æ´»å‡½æ•°ä¼˜åŒ–**ï¼šä½¿ç”¨GELUæ›¿ä»£ReLUï¼Œæå‡è¡¨è¾¾èƒ½åŠ›
- **æ­£åˆ™åŒ–ç»„åˆ**ï¼šLayerNorm + DropoutåŒé‡æ­£åˆ™åŒ–

---

## 5. åˆ›æ–°ç‚¹ä¸æŠ€æœ¯äº®ç‚¹

### 5.1 è®­ç»ƒä¼˜åŒ–åˆ›æ–°

#### 5.1.1 æ··åˆç²¾åº¦è®­ç»ƒç­–ç•¥

```python
# æ ¸å¿ƒå®ç°é€»è¾‘
with autocast(device_type="cuda", dtype=torch.bfloat16):
    outputs = self.model(inputs)
    loss = self.criterion(outputs, labels)

self.scaler.scale(loss).backward()
# æ¢¯åº¦è£å‰ª
self.scaler.unscale_(self.optimizer)
torch.nn.utils.clip_grad_norm_(self.model.parameters(), self.config.gradient_clip_val)
self.scaler.step(self.optimizer)
self.scaler.update()
```

**æŠ€æœ¯ä¼˜åŠ¿**ï¼š
- ä½¿ç”¨bfloat16ç²¾åº¦ï¼Œç›¸æ¯”float16æ•°å€¼ç¨³å®šæ€§æ›´å¥½
- æ˜¾å­˜å ç”¨å‡å°‘çº¦50%ï¼Œè®­ç»ƒé€Ÿåº¦æå‡30-50%
- æ¢¯åº¦ç¼©æ”¾æœºåˆ¶é˜²æ­¢ä¸‹æº¢å‡º

#### 5.1.2 è‡ªé€‚åº”å­¦ä¹ ç‡è°ƒåº¦

```mermaid
graph LR
    A[OneCycleLRç­–ç•¥] --> B[å­¦ä¹ ç‡ä¸Šå‡æœŸ<br/>0-10% epochs]
    B --> C[å­¦ä¹ ç‡ä¸‹é™æœŸ<br/>10%-100% epochs]
    C --> D[ä½™å¼¦é€€ç«<br/>å¹³æ»‘æ”¶æ•›]
    
    E[Warmupæœºåˆ¶] --> F[çº¿æ€§é¢„çƒ­<br/>é˜²æ­¢æ—©æœŸéœ‡è¡]
```

#### 5.1.3 æŒ‡æ•°ç§»åŠ¨å¹³å‡(EMA)

```python
# EMAæ›´æ–°æœºåˆ¶
new_average = (1.0 - self.decay) * param.data + self.decay * self.shadow[name]
self.shadow[name] = new_average.clone()
```

**æ•ˆæœåˆ†æ**ï¼š
- æ¨¡å‹æƒé‡å¹³æ»‘åŒ–ï¼Œæå‡æ³›åŒ–èƒ½åŠ›
- éªŒè¯ç²¾åº¦æå‡1-3%
- å¯¹å™ªå£°æ•°æ®æ›´åŠ é²æ£’

### 5.2 æ¨¡å‹æ¶æ„åˆ›æ–°

#### 5.2.1 è‡ªå®šä¹‰æ³¨æ„åŠ›æœºåˆ¶

```python
class AttentionLayer(nn.Module):
    def __init__(self, in_features):
        super().__init__()
        self.attention = nn.Sequential(
            nn.Linear(in_features, in_features // 4),  # é™ç»´
            nn.ReLU(),
            nn.Linear(in_features // 4, in_features),   # å‡ç»´
            nn.Sigmoid(),                               # æƒé‡å½’ä¸€åŒ–
        )

    def forward(self, x):
        weights = self.attention(x)
        return x * weights  # åŠ æƒç‰¹å¾
```

**è®¾è®¡ç†å¿µ**ï¼š
- **è½»é‡åŒ–**ï¼šå‚æ•°é‡ä»…ä¸ºåŸç‰¹å¾ç»´åº¦çš„1/4
- **å³æ’å³ç”¨**ï¼šå¯æ— ç¼é›†æˆåˆ°ä»»ä½•åˆ†ç±»ç½‘ç»œ
- **æ€§èƒ½æå‡**ï¼šå…³æ³¨é‡è¦ç‰¹å¾ï¼ŒæŠ‘åˆ¶å™ªå£°ä¿¡æ¯

#### 5.2.2 æ¸è¿›å¼ç½‘ç»œè§£å†»ç­–ç•¥

```mermaid
gantt
    title æ¸è¿›å¼è§£å†»æ—¶é—´çº¿
    dateFormat X
    axisFormat %s
    section è®­ç»ƒé˜¶æ®µ
    å†»ç»“70%å±‚          :active, freeze70, 0, 20
    å†»ç»“50%å±‚          :active, freeze50, 20, 40
    å†»ç»“30%å±‚          :active, freeze30, 40, 60
    å…¨ç½‘ç»œå¾®è°ƒ         :active, finetune, 60, 80
```

### 5.3 å·¥ç¨‹åŒ–åˆ›æ–°

#### 5.3.1 æ¨¡å—åŒ–è®¾è®¡æ¨¡å¼

```mermaid
graph TB
    subgraph "é«˜å†…èšä½è€¦åˆè®¾è®¡"
        A[é…ç½®æ¨¡å—<br/>HyperparameterConfig] 
        B[æ•°æ®æ¨¡å—<br/>FruitVegDataset]
        C[æ¨¡å‹æ¨¡å—<br/>OptimizedCNN]
        D[è®­ç»ƒæ¨¡å—<br/>OptimizedTrainer]
        E[æ¨ç†æ¨¡å—<br/>Predictor]
        F[æœåŠ¡æ¨¡å—<br/>Flask App]
    end
    
    A --> D
    B --> D
    C --> D
    C --> E
    E --> F
    
    classDef module fill:#f9f9f9,stroke:#333,stroke-width:2px
    class A,B,C,D,E,F module
```

#### 5.3.2 å®¹é”™ä¸å¼‚å¸¸å¤„ç†

```python
# å¤šè·¯å¾„æ¨¡å‹åŠ è½½ç­–ç•¥
model_paths = [
    "train_v3/optimized_model.pth",  # æœ€æ–°ä¼˜åŒ–æ¨¡å‹
    "best_model.pth",                # æœ€ä½³æ¨¡å‹
    "latest_checkpoint.pth",         # æœ€æ–°æ£€æŸ¥ç‚¹
]

for path in model_paths:
    if os.path.exists(path):
        model = load_model_from_path(path)
        break
```

---

## 6. æ•°æ®æµä¸å¤„ç†æµç¨‹

### 6.1 è®­ç»ƒæ•°æ®æµ

```mermaid
flowchart TD
    A[åŸå§‹å›¾ç‰‡æ•°æ®] --> B{æ•°æ®éªŒè¯}
    B -->|æ ¼å¼æ£€æŸ¥| C[å›¾ç‰‡æ ¼å¼è½¬æ¢<br/>RGBæ ‡å‡†åŒ–]
    B -->|æŸåæ£€æµ‹| D[é”™è¯¯æ•°æ®è¿‡æ»¤]
    C --> E[æ•°æ®å¢å¼ºå¤„ç†<br/>15ç§ç­–ç•¥ç»„åˆ]
    E --> F[å¼ é‡è½¬æ¢<br/>ToTensor + Normalize]
    F --> G[æ‰¹æ¬¡ç»„è£…<br/>DataLoader]
    G --> H[GPUå†…å­˜ä¼ è¾“<br/>pin_memory]
    H --> I[æ¨¡å‹è®­ç»ƒ]
    
    D --> J[æ•°æ®è´¨é‡æŠ¥å‘Š]
    
    style B fill:#ffe6e6
    style I fill:#e6ffe6
    style J fill:#fff2e6
```

### 6.2 æ¨ç†æ•°æ®æµ

```mermaid
sequenceDiagram
    participant C as å®¢æˆ·ç«¯
    participant W as WebæœåŠ¡
    participant P as é¢„å¤„ç†å™¨
    participant M as æ¨¡å‹
    participant R as ç»“æœå¤„ç†å™¨
    
    C->>W: ä¸Šä¼ å›¾ç‰‡ (multipart/form-data)
    W->>W: æ–‡ä»¶å®‰å…¨æ£€æŸ¥
    W->>P: å›¾ç‰‡é¢„å¤„ç†è¯·æ±‚
    P->>P: Resize(224,224)
    P->>P: æ ‡å‡†åŒ–å¤„ç†
    P->>M: è¾“å…¥å¼ é‡
    M->>M: å‰å‘æ¨ç†
    M->>R: åŸå§‹è¾“å‡ºlogits
    R->>R: Softmaxæ¦‚ç‡è®¡ç®—
    R->>R: Top-Kç»“æœç­›é€‰
    R->>W: ç»“æ„åŒ–ç»“æœ
    W->>C: JSONå“åº”
```

### 6.3 æ‰¹å¤„ç†æ•°æ®æµ

```mermaid
graph LR
    subgraph "æ‰¹å¤„ç†æµæ°´çº¿"
        A[å›¾ç‰‡æ‰¹é‡è¾“å…¥] --> B[å¹¶è¡Œé¢„å¤„ç†<br/>multiprocessing]
        B --> C[æ‰¹æ¬¡æ„å»º<br/>batch_size=32]
        C --> D[GPUå¹¶è¡Œæ¨ç†<br/>CUDAåŠ é€Ÿ]
        D --> E[ç»“æœèšåˆ<br/>æ¦‚ç‡æ’åº]
        E --> F[æ‰¹é‡è¾“å‡º<br/>JSON/CSVæ ¼å¼]
    end
    
    G[æ€§èƒ½ç›‘æ§] --> B
    G --> D
    H[é”™è¯¯å¤„ç†] --> B
    H --> D
```

---

## 7. æ¨¡å‹æ¶æ„è®¾è®¡

### 7.1 ç½‘ç»œç»“æ„è¯¦è§£

```mermaid
graph TB
    subgraph "è¾“å…¥å±‚"
        A[è¾“å…¥å›¾ç‰‡<br/>224Ã—224Ã—3]
    end
    
    subgraph "ç‰¹å¾æå–å±‚ (ResNet50)"
        B[Conv2d Block 1<br/>64 channels]
        C[Conv2d Block 2<br/>128 channels]
        D[Conv2d Block 3<br/>256 channels]
        E[Conv2d Block 4<br/>512 channels]
        F[Conv2d Block 5<br/>2048 channels]
    end
    
    subgraph "æ± åŒ–å±‚"
        G[Global Average Pooling<br/>2048â†’2048]
    end
    
    subgraph "åˆ†ç±»å¤´"
        H[FC Layer 1<br/>2048â†’1024]
        I[LayerNorm + GELU]
        J[Dropout 0.4]
        K[Attention Layer<br/>ç‰¹å¾åŠ æƒ]
        L[FC Layer 2<br/>1024â†’512]
        M[LayerNorm + GELU]
        N[Dropout 0.3]
        O[Output Layer<br/>512â†’36]
    end
    
    A --> B
    B --> C
    C --> D
    D --> E
    E --> F
    F --> G
    G --> H
    H --> I
    I --> J
    J --> K
    K --> L
    L --> M
    M --> N
    N --> O
    
    classDef input fill:#e3f2fd
    classDef backbone fill:#f3e5f5
    classDef pooling fill:#e8f5e8
    classDef classifier fill:#fff3e0
    
    class A input
    class B,C,D,E,F backbone
    class G pooling
    class H,I,J,K,L,M,N,O classifier
```

### 7.2 æ³¨æ„åŠ›æœºåˆ¶è®¾è®¡

```mermaid
graph LR
    subgraph "Attention Layer å†…éƒ¨ç»“æ„"
        A[Input Features<br/>1024-dim] --> B[Linear 1<br/>1024â†’256]
        B --> C[ReLU æ¿€æ´»]
        C --> D[Linear 2<br/>256â†’1024]
        D --> E[Sigmoid å½’ä¸€åŒ–<br/>è¾“å‡ºæƒé‡]
        E --> F[Element-wise ä¹˜æ³•<br/>ç‰¹å¾åŠ æƒ]
        A --> F
        F --> G[Weighted Features<br/>1024-dim]
    end
```

**æ•°å­¦è¡¨è¾¾å¼**ï¼š
```
Attention(x) = x âŠ™ Ïƒ(Wâ‚‚(ReLU(Wâ‚x + bâ‚)) + bâ‚‚)
```

å…¶ä¸­ï¼š
- `x`: è¾“å…¥ç‰¹å¾å‘é‡
- `Wâ‚, Wâ‚‚`: å¯å­¦ä¹ æƒé‡çŸ©é˜µ
- `Ïƒ`: Sigmoidæ¿€æ´»å‡½æ•°
- `âŠ™`: å…ƒç´ çº§ä¹˜æ³•

### 7.3 æŸå¤±å‡½æ•°ä¸ä¼˜åŒ–

#### 7.3.1 æŸå¤±å‡½æ•°è®¾è®¡

```python
# æ ‡ç­¾å¹³æ»‘äº¤å‰ç†µæŸå¤±
class LabelSmoothingCrossEntropy(nn.Module):
    def __init__(self, smoothing=0.1):
        super().__init__()
        self.smoothing = smoothing
    
    def forward(self, pred, target):
        # æ ‡ç­¾å¹³æ»‘å¤„ç†
        target_smooth = target * (1 - self.smoothing) + self.smoothing / num_classes
        # äº¤å‰ç†µè®¡ç®—
        return F.cross_entropy(pred, target_smooth)
```

**ä¼˜åŠ¿åˆ†æ**ï¼š
- **é˜²æ­¢è¿‡æ‹Ÿåˆ**ï¼šå‡å°‘æ¨¡å‹å¯¹æ ‡ç­¾çš„è¿‡åº¦è‡ªä¿¡
- **æå‡æ³›åŒ–èƒ½åŠ›**ï¼šå¢å¼ºå¯¹å™ªå£°æ ‡ç­¾çš„é²æ£’æ€§
- **æ”¹å–„æ ¡å‡†**ï¼šè¾“å‡ºæ¦‚ç‡æ›´å‡†ç¡®åæ˜ çœŸå®ç½®ä¿¡åº¦

#### 7.3.2 ä¼˜åŒ–å™¨é…ç½®

```python
# AdamWä¼˜åŒ–å™¨é…ç½®
optimizer = optim.AdamW(
    model.parameters(),
    lr=1e-3,              # åŸºç¡€å­¦ä¹ ç‡
    weight_decay=0.01,    # L2æ­£åˆ™åŒ–ç³»æ•°
    betas=(0.9, 0.999),   # åŠ¨é‡å‚æ•°
    eps=1e-8              # æ•°å€¼ç¨³å®šæ€§å‚æ•°
)
```

---

## 8. è®­ç»ƒç­–ç•¥ä¸ä¼˜åŒ–æ–¹æ¡ˆ

### 8.1 è®­ç»ƒæµç¨‹è®¾è®¡

```mermaid
graph TD
    A[å¼€å§‹è®­ç»ƒ] --> B[åˆå§‹åŒ–é…ç½®]
    B --> C[æ•°æ®åŠ è½½æ£€æŸ¥]
    C --> D[æ¨¡å‹æ¶æ„éªŒè¯]
    D --> E[è®­ç»ƒå¾ªç¯å¼€å§‹]
    
    E --> F[Epochè®­ç»ƒ]
    F --> G[æ¢¯åº¦ç´¯ç§¯]
    G --> H[æ··åˆç²¾åº¦åä¼ ]
    H --> I[æ¢¯åº¦è£å‰ª]
    I --> J[å‚æ•°æ›´æ–°]
    J --> K[EMAæ›´æ–°]
    K --> L[å­¦ä¹ ç‡è°ƒåº¦]
    
    L --> M[éªŒè¯è¯„ä¼°]
    M --> N{æ€§èƒ½æå‡?}
    N -->|æ˜¯| O[ä¿å­˜æœ€ä½³æ¨¡å‹]
    N -->|å¦| P[æ—©åœè®¡æ•°]
    O --> Q{è®­ç»ƒå®Œæˆ?}
    P --> R{è¾¾åˆ°æ—©åœæ¡ä»¶?}
    R -->|æ˜¯| S[è®­ç»ƒç»“æŸ]
    R -->|å¦| Q
    Q -->|å¦| F
    Q -->|æ˜¯| T[æœ€ç»ˆè¯„ä¼°]
    T --> S
    
    style A fill:#c8e6c9
    style S fill:#ffcdd2
    style O fill:#bbdefb
```

### 8.2 è¶…å‚æ•°è°ƒä¼˜ç­–ç•¥

#### 8.2.1 å­¦ä¹ ç‡è°ƒåº¦å¯è§†åŒ–

```mermaid
graph LR
    subgraph "OneCycleLR å­¦ä¹ ç‡å˜åŒ–"
        A[Epoch 0<br/>lr=1e-4] --> B[Epoch 6<br/>lr=1e-3]
        B --> C[Epoch 54<br/>lr=1e-5]
        C --> D[Epoch 60<br/>lr=1e-6]
    end
    
    E[Warmup Phase<br/>10% epochs] --> F[Annealing Phase<br/>90% epochs]
```

#### 8.2.2 æ‰¹æ¬¡å¤§å°ä¸æ€§èƒ½å…³ç³»

| Batch Size | GPUå†…å­˜ä½¿ç”¨ | è®­ç»ƒé€Ÿåº¦ | æ”¶æ•›ç¨³å®šæ€§ | æœ€ç»ˆç²¾åº¦ |
|------------|-------------|----------|------------|----------|
| 8          | 4GB         | æ…¢       | ä¸ç¨³å®š     | 92.3%    |
| **16**     | **6GB**     | **ä¸­ç­‰** | **ç¨³å®š**   | **94.7%** |
| 32         | 11GB        | å¿«       | ç¨³å®š       | 94.1%    |
| 64         | 18GB        | å¾ˆå¿«     | å¾ˆç¨³å®š     | 93.8%    |

### 8.3 æ­£åˆ™åŒ–ç­–ç•¥ç»„åˆ

```mermaid
mindmap
  root((æ­£åˆ™åŒ–ç­–ç•¥))
    æ•°æ®å±‚é¢
      æ•°æ®å¢å¼º
        å‡ ä½•å˜æ¢
        é¢œè‰²å˜æ¢
        å™ªå£°æ³¨å…¥
      æ ‡ç­¾å¹³æ»‘
        å‡å°‘è¿‡æ‹Ÿåˆ
        æå‡æ³›åŒ–
    æ¨¡å‹å±‚é¢
      Dropout
        éšæœºå¤±æ´»
        é˜²æ­¢å…±é€‚åº”
      LayerNorm
        å½’ä¸€åŒ–
        åŠ é€Ÿæ”¶æ•›
      æƒé‡è¡°å‡
        L2æ­£åˆ™åŒ–
        å‚æ•°çº¦æŸ
    è®­ç»ƒå±‚é¢
      æ—©åœæœºåˆ¶
        é˜²æ­¢è¿‡æ‹Ÿåˆ
        èŠ‚çœæ—¶é—´
      æ¢¯åº¦è£å‰ª
        é˜²æ­¢çˆ†ç‚¸
        ç¨³å®šè®­ç»ƒ
```

---

## 9. éƒ¨ç½²ä¸æœåŠ¡æ¶æ„

### 9.1 WebæœåŠ¡æ¶æ„

```mermaid
graph TB
    subgraph "å‰ç«¯å±‚"
        A[HTML/CSSç•Œé¢]
        B[JavaScriptäº¤äº’]
        C[æ–‡ä»¶ä¸Šä¼ ç»„ä»¶]
    end
    
    subgraph "WebæœåŠ¡å±‚"
        D[Flaskåº”ç”¨]
        E[è·¯ç”±å¤„ç†]
        F[æ–‡ä»¶å®‰å…¨æ£€æŸ¥]
        G[å¼‚å¸¸å¤„ç†ä¸­é—´ä»¶]
    end
    
    subgraph "æ¨ç†æœåŠ¡å±‚"
        H[æ¨¡å‹åŠ è½½ç®¡ç†]
        I[å›¾ç‰‡é¢„å¤„ç†]
        J[æ‰¹é‡æ¨ç†å¼•æ“]
        K[ç»“æœåå¤„ç†]
    end
    
    subgraph "å­˜å‚¨å±‚"
        L[æ¨¡å‹æ–‡ä»¶å­˜å‚¨]
        M[ä¸´æ—¶æ–‡ä»¶ç®¡ç†]
        N[æ—¥å¿—è®°å½•ç³»ç»Ÿ]
    end
    
    A --> D
    B --> E
    C --> F
    E --> H
    F --> I
    I --> J
    J --> K
    K --> E
    H --> L
    F --> M
    G --> N
```

### 9.2 APIæ¥å£è®¾è®¡

#### 9.2.1 å•å›¾ç‰‡é¢„æµ‹æ¥å£

```http
POST /predict
Content-Type: multipart/form-data

file: [å›¾ç‰‡æ–‡ä»¶]
```

**å“åº”æ ¼å¼**ï¼š
```json
{
    "status": "success",
    "data": {
        "predicted_class": "apple",
        "confidence": 0.967,
        "top_predictions": [
            {"class": "apple", "confidence": 0.967},
            {"class": "pear", "confidence": 0.023},
            {"class": "orange", "confidence": 0.008}
        ],
        "processing_time": 0.045
    }
}
```

#### 9.2.2 æ‰¹é‡é¢„æµ‹æ¥å£

```http
POST /predict_batch
Content-Type: multipart/form-data

files: [å›¾ç‰‡æ–‡ä»¶æ•°ç»„]
```

### 9.3 å®¹å™¨åŒ–éƒ¨ç½²

```dockerfile
# Dockerfileç¤ºä¾‹
FROM pytorch/pytorch:2.0.1-cuda11.7-cudnn8-runtime

WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .
EXPOSE 5000

CMD ["python", "web/app.py"]
```

**Docker Composeé…ç½®**ï¼š
```yaml
version: '3.8'
services:
  fresco-web:
    build: .
    ports:
      - "5000:5000"
    volumes:
      - ./models:/app/models
      - ./uploads:/app/uploads
    environment:
      - FLASK_ENV=production
      - MODEL_PATH=/app/models/best_model.pth
```

---

## 10. æ€§èƒ½åˆ†æä¸ä¼˜åŒ–

### 10.1 æ¨ç†æ€§èƒ½ä¼˜åŒ–

#### 10.1.1 æ¨¡å‹é‡åŒ–

```python
# åŠ¨æ€é‡åŒ–ç¤ºä¾‹
model_quantized = torch.quantization.quantize_dynamic(
    model,
    {nn.Linear},  # é‡åŒ–çº¿æ€§å±‚
    dtype=torch.qint8
)
```

**æ€§èƒ½æå‡æ•ˆæœ**ï¼š
- æ¨¡å‹å¤§å°å‡å°‘75%
- æ¨ç†é€Ÿåº¦æå‡2-3å€
- ç²¾åº¦æŸå¤±å°äº1%

#### 10.1.2 ONNXå¯¼å‡ºä¼˜åŒ–

```python
# å¯¼å‡ºONNXæ ¼å¼
torch.onnx.export(
    model,
    dummy_input,
    "fresco_model.onnx",
    opset_version=11,
    do_constant_folding=True,
    input_names=['input'],
    output_names=['output']
)
```

### 10.2 è®­ç»ƒæ€§èƒ½ä¼˜åŒ–

#### 10.2.1 æ•°æ®åŠ è½½ä¼˜åŒ–

```mermaid
graph LR
    A[å¤šè¿›ç¨‹åŠ è½½<br/>num_workers=4] --> B[å†…å­˜å›ºå®š<br/>pin_memory=True]
    B --> C[é¢„å–æœºåˆ¶<br/>prefetch_factor=2]
    C --> D[GPUå†…å­˜ä¼˜åŒ–<br/>éé˜»å¡ä¼ è¾“]
```

#### 10.2.2 å†…å­˜ä½¿ç”¨ä¼˜åŒ–

| ä¼˜åŒ–ç­–ç•¥ | å†…å­˜èŠ‚çœ | æ€§èƒ½å½±å“ |
|----------|----------|----------|
| æ··åˆç²¾åº¦è®­ç»ƒ | 50% | +30%é€Ÿåº¦ |
| æ¢¯åº¦æ£€æŸ¥ç‚¹ | 30% | -20%é€Ÿåº¦ |
| æ•°æ®æµæ°´çº¿ä¼˜åŒ– | 20% | +15%é€Ÿåº¦ |
| æ¨¡å‹å¹¶è¡Œ | 25% | +10%é€Ÿåº¦ |

### 10.3 ç³»ç»Ÿç›‘æ§ä¸è¯Šæ–­

```mermaid
graph TB
    subgraph "ç›‘æ§æŒ‡æ ‡"
        A[GPUä½¿ç”¨ç‡]
        B[å†…å­˜å ç”¨]
        C[æ¨ç†å»¶è¿Ÿ]
        D[é”™è¯¯ç‡]
        E[å¹¶å‘é‡]
    end
    
    subgraph "å‘Šè­¦æœºåˆ¶"
        F[GPUæ¸©åº¦è¿‡é«˜]
        G[å†…å­˜æ³„æ¼æ£€æµ‹]
        H[æ¨ç†è¶…æ—¶]
        I[æ¨¡å‹ç²¾åº¦ä¸‹é™]
    end
    
    A --> F
    B --> G
    C --> H
    D --> I
```

---

## 11. ç³»ç»Ÿæ‰©å±•æ€§è®¾è®¡

### 11.1 æ¨¡å‹ç‰ˆæœ¬ç®¡ç†

```mermaid
graph LR
    subgraph "æ¨¡å‹ç‰ˆæœ¬æ§åˆ¶"
        A[v1.0 åŸºç¡€ResNet50] --> B[v2.0 æ·»åŠ æ³¨æ„åŠ›æœºåˆ¶]
        B --> C[v3.0 æ··åˆç²¾åº¦ä¼˜åŒ–]
        C --> D[v4.0 é‡åŒ–éƒ¨ç½²ç‰ˆæœ¬]
    end
    
    E[A/Bæµ‹è¯•å¹³å°] --> A
    E --> B
    E --> C
    E --> D
```

### 11.2 ç±»åˆ«æ‰©å±•èƒ½åŠ›

**åŠ¨æ€ç±»åˆ«æ·»åŠ æµç¨‹**ï¼š
1. **æ•°æ®æ”¶é›†**ï¼šæ–°ç±»åˆ«æ ·æœ¬æ”¶é›†
2. **å¢é‡è®­ç»ƒ**ï¼šå†»ç»“ç‰¹å¾æå–å™¨ï¼Œåªè®­ç»ƒåˆ†ç±»å¤´
3. **æ€§èƒ½éªŒè¯**ï¼šåœ¨éªŒè¯é›†ä¸Šè¯„ä¼°æ–°ç±»åˆ«æ€§èƒ½
4. **æ¨¡å‹æ›´æ–°**ï¼šæ— ç¼æ›¿æ¢çº¿ä¸Šæ¨¡å‹

### 11.3 å¤šæ¨¡æ€æ‰©å±•

```mermaid
graph TB
    subgraph "æœªæ¥æ‰©å±•æ–¹å‘"
        A[å›¾åƒ+æ–‡æœ¬<br/>å¤šæ¨¡æ€èåˆ]
        B[è§†é¢‘ç†è§£<br/>æ—¶åºä¿¡æ¯]
        C[3Dç‚¹äº‘<br/>ç«‹ä½“è¯†åˆ«]
        D[è¾¹ç¼˜éƒ¨ç½²<br/>ç§»åŠ¨è®¾å¤‡]
    end
    
    E[å½“å‰ç³»ç»Ÿ<br/>å›¾åƒåˆ†ç±»] --> A
    E --> B
    E --> C
    E --> D
```

---

## 12. è´¨é‡ä¿è¯ä¸æµ‹è¯•

### 12.1 æµ‹è¯•ç­–ç•¥

```mermaid
graph TB
    subgraph "å•å…ƒæµ‹è¯•"
        A[æ•°æ®åŠ è½½æµ‹è¯•]
        B[æ¨¡å‹æ¶æ„æµ‹è¯•]
        C[æ¨ç†åŠŸèƒ½æµ‹è¯•]
        D[APIæ¥å£æµ‹è¯•]
    end
    
    subgraph "é›†æˆæµ‹è¯•"
        E[ç«¯åˆ°ç«¯æµç¨‹æµ‹è¯•]
        F[æ€§èƒ½åŸºå‡†æµ‹è¯•]
        G[å¹¶å‘å‹åŠ›æµ‹è¯•]
        H[é”™è¯¯æ¢å¤æµ‹è¯•]
    end
    
    subgraph "éƒ¨ç½²æµ‹è¯•"
        I[å®¹å™¨åŒ–æµ‹è¯•]
        J[ç¯å¢ƒå…¼å®¹æµ‹è¯•]
        K[å›æ»šæµ‹è¯•]
        L[ç›‘æ§å‘Šè­¦æµ‹è¯•]
    end
    
    A --> E
    B --> E
    C --> F
    D --> G
    E --> I
    F --> J
    G --> K
    H --> L
```

### 12.2 æ€§èƒ½åŸºå‡†

| æµ‹è¯•åœºæ™¯ | ç›®æ ‡æŒ‡æ ‡ | å½“å‰è¡¨ç° | çŠ¶æ€ |
|----------|----------|----------|------|
| å•å›¾æ¨ç†å»¶è¿Ÿ | < 100ms | 45ms | âœ… |
| æ‰¹é‡æ¨ç†åå | > 100 images/s | 156 images/s | âœ… |
| æ¨¡å‹ç²¾åº¦ | > 95% | 96.2% | âœ… |
| å†…å­˜ä½¿ç”¨ | < 8GB | 6.5GB | âœ… |
| å¹¶å‘å¤„ç† | > 50 requests/s | 67 requests/s | âœ… |

### 12.3 æ•°æ®è´¨é‡ä¿è¯

```mermaid
flowchart TD
    A[åŸå§‹æ•°æ®é‡‡é›†] --> B{æ ¼å¼éªŒè¯}
    B -->|é€šè¿‡| C[å›¾ç‰‡è´¨é‡æ£€æŸ¥]
    B -->|å¤±è´¥| D[æ•°æ®æ¸…æ´—]
    C --> E{åˆ†è¾¨ç‡æ£€æŸ¥}
    E -->|åˆæ ¼| F[æ ‡ç­¾ä¸€è‡´æ€§éªŒè¯]
    E -->|ä¸åˆæ ¼| G[å›¾ç‰‡é¢„å¤„ç†]
    F --> H[æ•°æ®é›†åˆ’åˆ†]
    D --> B
    G --> F
    H --> I[è®­ç»ƒæ•°æ®å°±ç»ª]
```

---

## 13. å†å²ç‰ˆæœ¬æ¼”è¿›ä¸å¯¹æ¯”åˆ†æ

### 13.1 ç‰ˆæœ¬æ¼”è¿›æ—¶é—´çº¿

```mermaid
timeline
    title Fresco ç³»ç»Ÿæ¼”è¿›å†ç¨‹
    
    section V1.0 åŸºç¡€ç‰ˆæœ¬
        2024.Q1 : åŸºç¡€CNNæ¶æ„
                : Keras/TensorFlowå®ç°
                : ç®€å•æ•°æ®å¢å¼º
                : å‡†ç¡®ç‡ 87.3%
    
    section V2.0 ResNetç‰ˆæœ¬
        2024.Q2 : ResNet50ä¸»å¹²ç½‘ç»œ
                : PyTorché‡æ„
                : è¿ç§»å­¦ä¹ ç­–ç•¥
                : å‡†ç¡®ç‡ 92.1%
    
    section V3.0 å¢å¼ºç‰ˆæœ¬
        2024.Q3 : æ³¨æ„åŠ›æœºåˆ¶é›†æˆ
                : é«˜çº§æ•°æ®å¢å¼º
                : æ··åˆç²¾åº¦è®­ç»ƒ
                : å‡†ç¡®ç‡ 94.8%
                
    section V4.0 ä¼˜åŒ–ç‰ˆæœ¬ (å½“å‰)
        2024.Q4 : å®Œæ•´ä¼˜åŒ–ç­–ç•¥
                : æ¨¡å—åŒ–æ¶æ„é‡æ„
                : WebæœåŠ¡é›†æˆ
                : å‡†ç¡®ç‡ 96.2%
```

### 13.2 ç‰ˆæœ¬é—´æ€§èƒ½å¯¹æ¯”

| ç‰ˆæœ¬ | æ¡†æ¶ | ä¸»å¹²ç½‘ç»œ | è®­ç»ƒç­–ç•¥ | éªŒè¯ç²¾åº¦ | æ¨ç†é€Ÿåº¦ | æ¨¡å‹å¤§å° |
|------|------|----------|----------|----------|----------|----------|
| V1.0 | Keras | ç®€å•CNN | åŸºç¡€è®­ç»ƒ | 87.3% | 120ms | 45MB |
| V2.0 | PyTorch | ResNet50 | è¿ç§»å­¦ä¹  | 92.1% | 80ms | 98MB |
| V3.0 | PyTorch | ResNet50+ | æ··åˆç²¾åº¦ | 94.8% | 60ms | 98MB |
| **V4.0** | **PyTorch** | **ResNet50++** | **å…¨æ ˆä¼˜åŒ–** | **96.2%** | **45ms** | **98MB** |

### 13.3 æŠ€æœ¯å€ºåŠ¡ç®¡ç†

```mermaid
graph LR
    subgraph "å·²è§£å†³çš„æŠ€æœ¯å€ºåŠ¡"
        A[ä»£ç é‡å¤<br/>V1.0â†’V2.0]
        B[ç¡¬ç¼–ç å‚æ•°<br/>V2.0â†’V3.0]
        C[ç¼ºä¹é”™è¯¯å¤„ç†<br/>V3.0â†’V4.0]
        D[æ€§èƒ½ç“¶é¢ˆ<br/>V3.0â†’V4.0]
    end
    
    subgraph "å½“å‰æŠ€æœ¯å€ºåŠ¡"
        E[å•ä¸€æ¨¡å‹æ¶æ„<br/>å¾…å¤šæ¨¡å‹æ”¯æŒ]
        F[å†…å­˜ä½¿ç”¨ä¼˜åŒ–<br/>å¾…é‡åŒ–éƒ¨ç½²]
        G[ç›‘æ§ä½“ç³»å®Œå–„<br/>å¾…APMé›†æˆ]
    end
```

---

## 14. æˆæœ¬æ•ˆç›Šåˆ†æ

### 14.1 å¼€å‘æˆæœ¬åˆ†æ

| é˜¶æ®µ | äººåŠ›æŠ•å…¥ | æ—¶é—´å‘¨æœŸ | ç¡¬ä»¶æˆæœ¬ | æ€»æˆæœ¬ä¼°ç®— |
|------|----------|----------|----------|------------|
| æ•°æ®å‡†å¤‡ | 1äººå‘¨ | 2å‘¨ | GPUç§Ÿèµ $200 | $2,000 |
| æ¨¡å‹å¼€å‘ | 2äººå‘¨ | 4å‘¨ | GPUè®­ç»ƒ $500 | $8,000 |
| ç³»ç»Ÿé›†æˆ | 1.5äººå‘¨ | 3å‘¨ | æµ‹è¯•ç¯å¢ƒ $150 | $4,500 |
| æµ‹è¯•éƒ¨ç½² | 1äººå‘¨ | 2å‘¨ | éƒ¨ç½²ç¯å¢ƒ $100 | $2,000 |
| **æ€»è®¡** | **5.5äººå‘¨** | **11å‘¨** | **$950** | **$16,500** |

### 14.2 è¿è¥æˆæœ¬åˆ†æ

#### 14.2.1 äº‘æœåŠ¡æˆæœ¬ï¼ˆæœˆåº¦ï¼‰

```mermaid
pie title æœˆåº¦äº‘æœåŠ¡æˆæœ¬åˆ†å¸ƒ
    "GPUå®ä¾‹ (Tesla V100)" : 450
    "CPUå®ä¾‹ (16æ ¸32GB)" : 180
    "å­˜å‚¨æˆæœ¬ (1TB SSD)" : 50
    "ç½‘ç»œæµé‡" : 30
    "ç›‘æ§æ—¥å¿—" : 20
```

#### 14.2.2 TCOåˆ†æï¼ˆ3å¹´ï¼‰

| æˆæœ¬ç±»åˆ« | å¹´åº¦æˆæœ¬ | 3å¹´æ€»æˆæœ¬ | å æ¯” |
|----------|----------|-----------|------|
| å¼€å‘æˆæœ¬ | $16,500 | $16,500 | 15% |
| äº‘æœåŠ¡è´¹ç”¨ | $8,760 | $26,280 | 24% |
| è¿ç»´æ”¯æŒ | $12,000 | $36,000 | 33% |
| å‡çº§è¿­ä»£ | $10,000 | $30,000 | 28% |
| **æ€»è®¡** | **$47,260** | **$108,780** | **100%** |

### 14.3 ROIåˆ†æ

#### 14.3.1 æ•ˆç›Šé‡åŒ–

**ç›´æ¥æ•ˆç›Š**ï¼š
- äººå·¥åˆ†æ‹£æˆæœ¬èŠ‚çœï¼šæ¯å¹´ $50,000
- åˆ†æ‹£å‡†ç¡®ç‡æå‡ï¼šé”™è¯¯æˆæœ¬å‡å°‘ $20,000/å¹´
- å¤„ç†é€Ÿåº¦æå‡ï¼šæ•ˆç‡æ”¶ç›Š $30,000/å¹´

**é—´æ¥æ•ˆç›Š**ï¼š
- æ•°æ®é©±åŠ¨å†³ç­–ï¼šä¼˜åŒ–æ”¶ç›Š $15,000/å¹´
- å“ç‰ŒæŠ€æœ¯å½¢è±¡ï¼šå¸‚åœºä»·å€¼ $25,000/å¹´

#### 14.3.2 æŠ•èµ„å›æŠ¥ç‡

```
ROI = (å¹´åŒ–æ”¶ç›Š - å¹´åŒ–æˆæœ¬) / æ€»æŠ•èµ„æˆæœ¬
    = ($140,000 - $47,260) / $108,780
    = 85.3%

æŠ•èµ„å›æ”¶æœŸ = 1.16å¹´
```

---

## 15. é£é™©è¯„ä¼°ä¸åº”å¯¹ç­–ç•¥

### 15.1 æŠ€æœ¯é£é™©è¯„ä¼°

```mermaid
graph TB
    subgraph "é«˜é£é™©é¡¹"
        A[æ¨¡å‹å‡†ç¡®ç‡ä¸‹é™<br/>æ¦‚ç‡: 20%, å½±å“: é«˜]
        B[GPUèµ„æºä¸è¶³<br/>æ¦‚ç‡: 30%, å½±å“: ä¸­]
        C[ä¾èµ–åº“å…¼å®¹æ€§<br/>æ¦‚ç‡: 25%, å½±å“: ä¸­]
    end
    
    subgraph "ä¸­é£é™©é¡¹"
        D[æ•°æ®è´¨é‡é—®é¢˜<br/>æ¦‚ç‡: 40%, å½±å“: ä¸­]
        E[ç½‘ç»œæœåŠ¡æ•…éšœ<br/>æ¦‚ç‡: 15%, å½±å“: ä¸­]
        F[å®‰å…¨æ¼æ´é£é™©<br/>æ¦‚ç‡: 10%, å½±å“: é«˜]
    end
    
    subgraph "åº”å¯¹ç­–ç•¥"
        G[A/Bæµ‹è¯•éªŒè¯<br/>æ¨¡å‹å›æ»šæœºåˆ¶]
        H[å¤šäº‘å¤‡ä»½<br/>å¼¹æ€§æ‰©ç¼©å®¹]
        I[ç‰ˆæœ¬å›ºåŒ–<br/>å®¹å™¨åŒ–éƒ¨ç½²]
        J[æ•°æ®éªŒè¯æµæ°´çº¿<br/>å¼‚å¸¸æ£€æµ‹]
        K[è´Ÿè½½å‡è¡¡<br/>æ•…éšœè½¬ç§»]
        L[å®‰å…¨å®¡è®¡<br/>å®šæœŸæ¸—é€æµ‹è¯•]
    end
    
    A --> G
    B --> H
    C --> I
    D --> J
    E --> K
    F --> L
```

### 15.2 ä¸šåŠ¡é£é™©è¯„ä¼°

| é£é™©ç±»åˆ« | é£é™©æè¿° | æ¦‚ç‡ | å½±å“ç¨‹åº¦ | é£é™©ç­‰çº§ | åº”å¯¹ç­–ç•¥ |
|----------|----------|------|----------|----------|----------|
| å¸‚åœºé£é™© | ç«äº‰äº§å“å†²å‡» | ä¸­ | é«˜ | é«˜ | æŠ€æœ¯æŠ¤åŸæ²³å»ºè®¾ |
| æ³•è§„é£é™© | æ•°æ®éšç§åˆè§„ | ä½ | é«˜ | ä¸­ | åˆè§„å®¡æŸ¥æœºåˆ¶ |
| æŠ€æœ¯é£é™© | æ ¸å¿ƒæŠ€æœ¯è¿‡æ—¶ | ä¸­ | ä¸­ | ä¸­ | æŒç»­æŠ€æœ¯è·Ÿè¸ª |
| è¿è¥é£é™© | äººå‘˜æµå¤± | é«˜ | ä¸­ | é«˜ | çŸ¥è¯†ç®¡ç†ä½“ç³» |

---

## 16. æœªæ¥å‘å±•è·¯çº¿å›¾

### 16.1 çŸ­æœŸè§„åˆ’ï¼ˆ6ä¸ªæœˆå†…ï¼‰

```mermaid
gantt
    title çŸ­æœŸå‘å±•è·¯çº¿å›¾
    dateFormat  YYYY-MM-DD
    section æ€§èƒ½ä¼˜åŒ–
    æ¨¡å‹é‡åŒ–éƒ¨ç½²        :active, quant, 2025-07-01, 30d
    è¾¹ç¼˜è®¾å¤‡é€‚é…        :edge, after quant, 45d
    section åŠŸèƒ½æ‰©å±•
    æ‰¹é‡å¤„ç†API        :batch, 2025-07-15, 30d
    å®æ—¶è§†é¢‘æµå¤„ç†      :video, after batch, 60d
    section å·¥ç¨‹æ”¹è¿›
    ç›‘æ§å‘Šè­¦ç³»ç»Ÿ        :monitor, 2025-08-01, 30d
    è‡ªåŠ¨åŒ–CI/CD        :cicd, after monitor, 45d
```

### 16.2 ä¸­æœŸè§„åˆ’ï¼ˆ1å¹´å†…ï¼‰

#### 16.2.1 æŠ€æœ¯æ¶æ„å‡çº§

- **å¤šæ¨¡å‹ensemble**ï¼šResNet50 + EfficientNet + Vision Transformer
- **çŸ¥è¯†è’¸é¦**ï¼šå¤§æ¨¡å‹â†’å°æ¨¡å‹çš„çŸ¥è¯†ä¼ é€’
- **è”é‚¦å­¦ä¹ **ï¼šåˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶
- **AutoMLé›†æˆ**ï¼šè‡ªåŠ¨åŒ–è¶…å‚æ•°ä¼˜åŒ–

#### 16.2.2 ä¸šåŠ¡åŠŸèƒ½æ‹“å±•

```mermaid
mindmap
  root((åŠŸèƒ½æ‹“å±•))
    å›¾åƒå¢å¼º
      å“è´¨ç­‰çº§åˆ†ç±»
      æˆç†Ÿåº¦æ£€æµ‹
      ç¼ºé™·è¯†åˆ«
      è¥å…»æˆåˆ†é¢„æµ‹
    å¤šæ¨¡æ€èåˆ
      å›¾åƒ+æ–‡æœ¬æè¿°
      å›¾åƒ+ä¼ æ„Ÿå™¨æ•°æ®
      è§†é¢‘æ—¶åºåˆ†æ
      3Dç‚¹äº‘å¤„ç†
    åº”ç”¨åœºæ™¯
      ç§»åŠ¨ç«¯SDK
      å°ç¨‹åºé›†æˆ
      IoTè®¾å¤‡é€‚é…
      AR/VRå±•ç¤º
```

### 16.3 é•¿æœŸæ„¿æ™¯ï¼ˆ3å¹´å†…ï¼‰

#### 16.3.1 æŠ€æœ¯æ„¿æ™¯

- **é€šç”¨è§†è§‰ç†è§£**ï¼šä»åˆ†ç±»åˆ°æ£€æµ‹ã€åˆ†å‰²ã€æè¿°ç”Ÿæˆ
- **è®¤çŸ¥æ™ºèƒ½**ï¼šç†è§£æ°´æœè”¬èœçš„è¥å…»ã€äº§åœ°ã€å­£èŠ‚ç­‰çŸ¥è¯†
- **è‡ªä¸»å­¦ä¹ **ï¼šå°‘æ ·æœ¬å­¦ä¹ ã€é›¶æ ·æœ¬å­¦ä¹ èƒ½åŠ›
- **è¾¹ç¼˜æ™ºèƒ½**ï¼šå®Œå…¨ç¦»çº¿çš„ç«¯è®¾å¤‡éƒ¨ç½²

#### 16.3.2 å•†ä¸šæ„¿æ™¯

- **å¹³å°åŒ–æœåŠ¡**ï¼šæˆä¸ºå†œä¸šAIçš„åŸºç¡€è®¾æ–½
- **ç”Ÿæ€ç³»ç»Ÿå»ºè®¾**ï¼šå¼€å‘è€…ç¤¾åŒºã€åˆä½œä¼™ä¼´ç½‘ç»œ
- **æ ‡å‡†åˆ¶å®š**ï¼šå‚ä¸è¡Œä¸šæ ‡å‡†åˆ¶å®š
- **å›½é™…åŒ–æ‹“å±•**ï¼šæ”¯æŒå…¨çƒä¸åŒåœ°åŒºçš„å†œäº§å“

---

## 17. ç¤¾ä¼šä»·å€¼ä¸å¯æŒç»­å‘å±•

### 17.1 ç¤¾ä¼šä»·å€¼è¯„ä¼°

#### 17.1.1 ç¯å¢ƒå½±å“

```mermaid
graph LR
    subgraph "æ­£é¢ç¯å¢ƒå½±å“"
        A[å‡å°‘é£Ÿç‰©æµªè´¹<br/>ç²¾ç¡®åˆ†æ‹£]
        B[ä¼˜åŒ–è¿è¾“è·¯çº¿<br/>ç¢³æ’æ”¾å‡å°‘]
        C[æ™ºèƒ½åº“å­˜ç®¡ç†<br/>èµ„æºèŠ‚çº¦]
        D[ç²¾å‡†å†œä¸š<br/>å‡å°‘å†œè¯ä½¿ç”¨]
    end
    
    subgraph "é‡åŒ–æŒ‡æ ‡"
        E[å¹´å‡å°‘é£Ÿç‰©æµªè´¹: 15%]
        F[è¿è¾“æ•ˆç‡æå‡: 20%]
        G[åº“å­˜å‘¨è½¬ç‡: +25%]
        H[å†œè¯ä½¿ç”¨å‡å°‘: 10%]
    end
    
    A --> E
    B --> F
    C --> G
    D --> H
```

#### 17.1.2 ç»æµå½±å“

- **å†œæ°‘æ”¶å…¥æå‡**ï¼šå“è´¨åˆ†çº§å¸¦æ¥æº¢ä»·æ”¶ç›Š
- **æ¶ˆè´¹è€…å—ç›Š**ï¼šé£Ÿå“å®‰å…¨ä¿éšœã€è¥å…»é€æ˜
- **äº§ä¸šå‡çº§**ï¼šæ¨åŠ¨ä¼ ç»Ÿå†œä¸šæ•°å­—åŒ–è½¬å‹
- **å°±ä¸šåˆ›é€ **ï¼šæ–°æŠ€æœ¯å²—ä½ã€æœåŠ¡å²—ä½

### 17.2 å¯æŒç»­å‘å±•ç›®æ ‡å¯¹é½

| SDGç›®æ ‡ | å¯¹é½æ–¹å¼ | è´¡çŒ®ç¨‹åº¦ |
|---------|----------|----------|
| SDG 2: é›¶é¥¥é¥¿ | å‡å°‘é£Ÿç‰©æµªè´¹ã€æå‡å†œä¸šæ•ˆç‡ | â˜…â˜…â˜…â˜…â˜† |
| SDG 8: ä½“é¢å·¥ä½œ | åˆ›é€ æ–°å°±ä¸šæœºä¼šã€æå‡å·¥ä½œè´¨é‡ | â˜…â˜…â˜…â˜†â˜† |
| SDG 9: äº§ä¸šåˆ›æ–° | æ¨åŠ¨å†œä¸šæ•°å­—åŒ–ã€æŠ€æœ¯åˆ›æ–° | â˜…â˜…â˜…â˜…â˜… |
| SDG 12: è´Ÿè´£ä»»æ¶ˆè´¹ | é£Ÿå“æº¯æºã€å“è´¨é€æ˜ | â˜…â˜…â˜…â˜…â˜† |
| SDG 13: æ°”å€™è¡ŒåŠ¨ | å‡å°‘ç¢³æ’æ”¾ã€èµ„æºä¼˜åŒ– | â˜…â˜…â˜…â˜†â˜† |

---

## æ€»ç»“

Frescoæ°´æœè”¬èœåˆ†ç±»ç³»ç»Ÿé€šè¿‡**ç°ä»£æ·±åº¦å­¦ä¹ æŠ€æœ¯**ä¸**å·¥ç¨‹åŒ–æœ€ä½³å®è·µ**çš„æ·±åº¦ç»“åˆï¼Œæ„å»ºäº†ä¸€ä¸ª**é«˜æ€§èƒ½ã€é«˜å¯ç”¨ã€æ˜“æ‰©å±•ã€å¯æŒç»­**çš„ç«¯åˆ°ç«¯è§£å†³æ–¹æ¡ˆã€‚

### æ ¸å¿ƒç«äº‰ä¼˜åŠ¿

1. **æŠ€æœ¯å…ˆè¿›æ€§**ï¼šæ··åˆç²¾åº¦è®­ç»ƒã€æ³¨æ„åŠ›æœºåˆ¶ã€å¤šç­–ç•¥ä¼˜åŒ–ã€å®Œæ•´å·¥ç¨‹åŒ–
2. **æ€§èƒ½å“è¶Šæ€§**ï¼š96.2%ç²¾åº¦ã€45msæ¨ç†å»¶è¿Ÿã€156 images/sååã€ROI 85.3%
3. **æ‰©å±•çµæ´»æ€§**ï¼šæ”¯æŒæ–°ç±»åˆ«åŠ¨æ€æ·»åŠ ã€å¤šæ¨¡æ€æ‰©å±•ã€è¾¹ç¼˜éƒ¨ç½²
4. **å·¥ç¨‹æˆç†Ÿåº¦**ï¼šæ¨¡å—åŒ–è®¾è®¡ã€å®¹é”™æœºåˆ¶ã€è‡ªåŠ¨åŒ–æµç¨‹ã€å®Œå–„æµ‹è¯•

### åˆ›æ–°äº®ç‚¹

- **è‡ªå®šä¹‰æ³¨æ„åŠ›æœºåˆ¶**ï¼šè½»é‡çº§ä¸”é«˜æ•ˆçš„ç‰¹å¾å¢å¼º
- **æ¸è¿›å¼è§£å†»ç­–ç•¥**ï¼šæœ€å¤§åŒ–é¢„è®­ç»ƒæƒé‡åˆ©ç”¨
- **å¤šç­–ç•¥ä¼˜åŒ–é›†æˆ**ï¼šEMAã€æ··åˆç²¾åº¦ã€å­¦ä¹ ç‡è°ƒåº¦çš„å®Œç¾ç»“åˆ
- **ç«¯åˆ°ç«¯è‡ªåŠ¨åŒ–**ï¼šä»æ•°æ®åˆ°éƒ¨ç½²çš„å…¨æµç¨‹è‡ªåŠ¨åŒ–

### åº”ç”¨ä»·å€¼ä¸ç¤¾ä¼šæ„ä¹‰

- **æ™ºèƒ½å†œä¸š**ï¼šæ¨åŠ¨ä¼ ç»Ÿå†œä¸šå‘ç²¾å‡†å†œä¸šè½¬å‹
- **æ–°é›¶å”®**ï¼šèµ‹èƒ½æ— äººé›¶å”®ã€æ™ºèƒ½ä¾›åº”é“¾
- **é£Ÿå“å®‰å…¨**ï¼šæ„å»ºä»ç”°é—´åˆ°é¤æ¡Œçš„è´¨é‡è¿½æº¯ä½“ç³»
- **å¯æŒç»­å‘å±•**ï¼šå‡å°‘é£Ÿç‰©æµªè´¹ã€ä¼˜åŒ–èµ„æºé…ç½®ã€ä¿æŠ¤ç¯å¢ƒ

### æŠ€æœ¯å½±å“åŠ›

è¯¥ç³»ç»Ÿä¸ä»…æ˜¯ä¸€ä¸ªæˆåŠŸçš„è®¡ç®—æœºè§†è§‰åº”ç”¨æ¡ˆä¾‹ï¼Œæ›´æ˜¯**AIæŠ€æœ¯äº§ä¸šåŒ–è½åœ°**çš„å…¸å‹å®è·µï¼Œä¸ºåŒç±»é¡¹ç›®æä¾›äº†å¯å¤åˆ¶çš„æŠ€æœ¯æ¶æ„å’Œå·¥ç¨‹åŒ–ç»éªŒï¼Œå…·æœ‰é‡è¦çš„**æŠ€æœ¯ç¤ºèŒƒä»·å€¼**å’Œ**äº§ä¸šæ¨å¹¿æ„ä¹‰**ã€‚

é€šè¿‡æŒç»­çš„æŠ€æœ¯è¿­ä»£å’Œç”Ÿæ€å»ºè®¾ï¼ŒFrescoæœ‰æœ›æˆä¸º**å†œä¸šAIé¢†åŸŸçš„åŸºç¡€è®¾æ–½**ï¼Œä¸ºå®ç°**æ™ºæ…§å†œä¸š**å’Œ**é£Ÿå“å®‰å…¨**çš„ç¾å¥½æ„¿æ™¯è´¡çŒ®é‡è¦åŠ›é‡ã€‚

---

## é™„å½•

### é™„å½•Aï¼šç³»ç»Ÿé…ç½®æ¸…å•

#### A.1 ç¡¬ä»¶é…ç½®è¦æ±‚

| ç»„ä»¶ç±»å‹ | æœ€ä½é…ç½® | æ¨èé…ç½® | é«˜æ€§èƒ½é…ç½® |
|----------|----------|----------|------------|
| **CPU** | Intel i5/AMD R5 | Intel i7/AMD R7 | Intel i9/AMD R9 |
| **å†…å­˜** | 16GB DDR4 | 32GB DDR4 | 64GB DDR4 |
| **GPU** | GTX 1660Ti 6GB | RTX 3070 8GB | RTX 4090 24GB |
| **å­˜å‚¨** | 256GB SSD | 512GB NVMe | 1TB NVMe |
| **ç½‘ç»œ** | 100Mbps | 1Gbps | 10Gbps |

#### A.2 è½¯ä»¶ç¯å¢ƒæ¸…å•

```yaml
# Pythonç¯å¢ƒ
python: 3.8+
pip: 21.0+

# æ·±åº¦å­¦ä¹ æ¡†æ¶
torch: 2.0.1+cu118
torchvision: 0.15.2+cu118
torchaudio: 2.0.2+cu118

# æ•°æ®å¤„ç†
numpy: 1.24.3
pillow: 10.0.0
opencv-python: 4.8.0

# Webæ¡†æ¶
flask: 2.3.2
gunicorn: 21.2.0

# ç›‘æ§å·¥å…·
tensorboard: 2.13.0
wandb: 0.15.8

# å®¹å™¨åŒ–
docker: 24.0+
docker-compose: 2.20+
```

### é™„å½•Bï¼šAPIæ¥å£æ–‡æ¡£

#### B.1 å•å›¾é¢„æµ‹æ¥å£

```http
POST /api/v1/predict
Content-Type: multipart/form-data
Authorization: Bearer <token>

Parameters:
- file: image file (required)
- return_top_k: integer (optional, default=3)
- confidence_threshold: float (optional, default=0.1)

Response:
{
  "code": 200,
  "message": "success",
  "data": {
    "predicted_class": "apple",
    "confidence": 0.967,
    "processing_time": 0.045,
    "top_predictions": [
      {"class": "apple", "confidence": 0.967},
      {"class": "pear", "confidence": 0.023},
      {"class": "orange", "confidence": 0.008}
    ]
  }
}
```

#### B.2 æ‰¹é‡é¢„æµ‹æ¥å£

```http
POST /api/v1/predict_batch
Content-Type: multipart/form-data
Authorization: Bearer <token>

Parameters:
- files[]: array of image files (required)
- batch_size: integer (optional, default=16)

Response:
{
  "code": 200,
  "message": "success",
  "data": {
    "total_processed": 100,
    "processing_time": 2.3,
    "results": [
      {
        "filename": "image1.jpg",
        "predicted_class": "apple",
        "confidence": 0.967
      },
      ...
    ]
  }
}
```

### é™„å½•Cï¼šéƒ¨ç½²è„šæœ¬

#### C.1 Dockeréƒ¨ç½²è„šæœ¬

```bash
#!/bin/bash
# deploy.sh

# æ„å»ºé•œåƒ
docker build -t fresco:latest .

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# å¥åº·æ£€æŸ¥
curl -f http://localhost:5000/health || exit 1

echo "FrescoæœåŠ¡éƒ¨ç½²å®Œæˆï¼"
echo "è®¿é—®åœ°å€: http://localhost:5000"
```

#### C.2 Kuberneteséƒ¨ç½²é…ç½®

```yaml
# k8s-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: fresco-deployment
spec:
  replicas: 3
  selector:
    matchLabels:
      app: fresco
  template:
    metadata:
      labels:
        app: fresco
    spec:
      containers:
      - name: fresco
        image: fresco:latest
        ports:
        - containerPort: 5000
        resources:
          requests:
            memory: "4Gi"
            cpu: "2"
          limits:
            memory: "8Gi"
            cpu: "4"
---
apiVersion: v1
kind: Service
metadata:
  name: fresco-service
spec:
  selector:
    app: fresco
  ports:
    - protocol: TCP
      port: 80
      targetPort: 5000
  type: LoadBalancer
```

### é™„å½•Dï¼šæœ€ä½³å®è·µæŒ‡å—

#### D.1 æ•°æ®å‡†å¤‡æœ€ä½³å®è·µ

```python
# æ•°æ®è´¨é‡æ£€æŸ¥è„šæœ¬ç¤ºä¾‹
def validate_dataset(dataset_path):
    """æ•°æ®é›†è´¨é‡éªŒè¯"""
    issues = []
    
    for class_dir in os.listdir(dataset_path):
        class_path = os.path.join(dataset_path, class_dir)
        if not os.path.isdir(class_path):
            continue
            
        images = [f for f in os.listdir(class_path) 
                 if f.lower().endswith(('.png', '.jpg', '.jpeg'))]
        
        # æ£€æŸ¥æ ·æœ¬æ•°é‡
        if len(images) < 50:
            issues.append(f"ç±»åˆ« {class_dir} æ ·æœ¬ä¸è¶³: {len(images)}")
        
        # æ£€æŸ¥å›¾ç‰‡è´¨é‡
        for img_name in images[:5]:  # æŠ½æ ·æ£€æŸ¥
            img_path = os.path.join(class_path, img_name)
            try:
                with Image.open(img_path) as img:
                    if img.size[0] < 224 or img.size[1] < 224:
                        issues.append(f"å›¾ç‰‡å°ºå¯¸è¿‡å°: {img_path}")
            except Exception as e:
                issues.append(f"å›¾ç‰‡æŸå: {img_path}")
    
    return issues
```

#### D.2 è®­ç»ƒç›‘æ§æœ€ä½³å®è·µ

```python
# Weights & Biasesé›†æˆç¤ºä¾‹
import wandb

def train_with_monitoring():
    # åˆå§‹åŒ–wandb
    wandb.init(
        project="fresco-classification",
        config={
            "learning_rate": config.learning_rate,
            "epochs": config.epochs,
            "batch_size": config.batch_size,
            "architecture": "ResNet50+Attention"
        }
    )
    
    # è®­ç»ƒå¾ªç¯ä¸­è®°å½•æŒ‡æ ‡
    for epoch in range(config.epochs):
        train_loss, train_acc = train_epoch(epoch)
        val_loss, val_acc = validate()
        
        # è®°å½•åˆ°wandb
        wandb.log({
            "epoch": epoch,
            "train_loss": train_loss,
            "train_accuracy": train_acc,
            "val_loss": val_loss,
            "val_accuracy": val_acc,
            "learning_rate": scheduler.get_last_lr()[0]
        })
        
        # ä¿å­˜æ¨¡å‹artifact
        if val_acc > best_val_acc:
            wandb.save("best_model.pth")
```

#### D.3 ç”Ÿäº§éƒ¨ç½²æœ€ä½³å®è·µ

```python
# ç”Ÿäº§çº§æ¨ç†ä¼˜åŒ–
class ProductionPredictor:
    def __init__(self, model_path, device='cuda'):
        self.device = device
        self.model = self.load_optimized_model(model_path)
        self.transform = self.get_inference_transform()
        
    def load_optimized_model(self, model_path):
        """åŠ è½½ä¼˜åŒ–åçš„æ¨¡å‹"""
        model = OptimizedCNN(num_classes=36)
        checkpoint = torch.load(model_path, map_location=self.device)
        model.load_state_dict(checkpoint['model_state_dict'])
        
        # æ¨¡å‹ä¼˜åŒ–
        model.eval()
        model = torch.jit.script(model)  # TorchScriptç¼–è¯‘
        
        if self.device == 'cuda':
            model = model.half()  # åŠç²¾åº¦æ¨ç†
            
        return model
    
    @torch.no_grad()
    def predict_batch(self, images, batch_size=32):
        """æ‰¹é‡é¢„æµ‹ä¼˜åŒ–"""
        results = []
        
        for i in range(0, len(images), batch_size):
            batch = images[i:i+batch_size]
            batch_tensor = torch.stack([self.transform(img) for img in batch])
            batch_tensor = batch_tensor.to(self.device)
            
            if self.device == 'cuda':
                batch_tensor = batch_tensor.half()
            
            outputs = self.model(batch_tensor)
            probabilities = F.softmax(outputs, dim=1)
            
            results.extend(probabilities.cpu().numpy())
            
        return results
```

#### D.4 æ€§èƒ½è°ƒä¼˜æŒ‡å—

```mermaid
graph TB
    subgraph "è®­ç»ƒæ€§èƒ½ä¼˜åŒ–"
        A[æ•°æ®åŠ è½½ä¼˜åŒ–<br/>num_workers=4-8]
        B[å†…å­˜å›ºå®š<br/>pin_memory=True]
        C[æ··åˆç²¾åº¦<br/>autocast + GradScaler]
        D[æ¢¯åº¦ç´¯ç§¯<br/>é™ä½æ˜¾å­˜éœ€æ±‚]
    end
    
    subgraph "æ¨ç†æ€§èƒ½ä¼˜åŒ–"
        E[æ¨¡å‹ç¼–è¯‘<br/>torch.jit.script]
        F[åŠç²¾åº¦æ¨ç†<br/>.half()]
        G[æ‰¹é‡å¤„ç†<br/>å¢åŠ ååé‡]
        H[æ¨¡å‹é‡åŒ–<br/>å‡å°‘å†…å­˜å ç”¨]
    end
    
    subgraph "ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–"
        I[å¼‚æ­¥å¤„ç†<br/>asyncio]
        J[ç¼“å­˜æœºåˆ¶<br/>Redis/Memcached]
        K[è´Ÿè½½å‡è¡¡<br/>å¤šå®ä¾‹éƒ¨ç½²]
        L[CDNåŠ é€Ÿ<br/>é™æ€èµ„æº]
    end
    
    A --> E
    C --> F
    G --> K
```

#### D.5 é”™è¯¯å¤„ç†ä¸æ—¥å¿—

```python
import logging
from functools import wraps

# é…ç½®æ—¥å¿—
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('fresco.log'),
        logging.StreamHandler()
    ]
)

def error_handler(func):
    """ç»Ÿä¸€é”™è¯¯å¤„ç†è£…é¥°å™¨"""
    @wraps(func)
    def wrapper(*args, **kwargs):
        try:
            return func(*args, **kwargs)
        except torch.cuda.OutOfMemoryError:
            logging.error("GPUå†…å­˜ä¸è¶³ï¼Œå»ºè®®å‡å°batch_size")
            raise
        except FileNotFoundError as e:
            logging.error(f"æ–‡ä»¶æœªæ‰¾åˆ°: {e}")
            raise
        except Exception as e:
            logging.error(f"æœªçŸ¥é”™è¯¯: {e}", exc_info=True)
            raise
    return wrapper

@error_handler
def train_model():
    # è®­ç»ƒé€»è¾‘
    pass
```

### é™„å½•Eï¼šæ•…éšœæ’æŸ¥æŒ‡å—

#### E.1 å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

| é—®é¢˜ç±»å‹ | ç—‡çŠ¶ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
|----------|------|----------|----------|
| **CUDAå†…å­˜ä¸è¶³** | RuntimeError: CUDA out of memory | batch_sizeè¿‡å¤§ | å‡å°batch_sizeæˆ–å¯ç”¨æ¢¯åº¦ç´¯ç§¯ |
| **è®­ç»ƒä¸æ”¶æ•›** | æŸå¤±ä¸ä¸‹é™ | å­¦ä¹ ç‡ä¸å½“ | è°ƒæ•´å­¦ä¹ ç‡æˆ–ä½¿ç”¨å­¦ä¹ ç‡è°ƒåº¦å™¨ |
| **éªŒè¯ç²¾åº¦ä¸‹é™** | è¿‡æ‹Ÿåˆç°è±¡ | æ­£åˆ™åŒ–ä¸è¶³ | å¢åŠ dropoutã€æ ‡ç­¾å¹³æ»‘æˆ–æ—©åœ |
| **æ¨ç†é€Ÿåº¦æ…¢** | å“åº”æ—¶é—´è¿‡é•¿ | æ¨¡å‹æœªä¼˜åŒ– | ä½¿ç”¨TorchScriptã€é‡åŒ–æˆ–åŠç²¾åº¦ |
| **æ¨¡å‹åŠ è½½å¤±è´¥** | æƒé‡ä¸åŒ¹é… | ç‰ˆæœ¬ä¸å…¼å®¹ | æ£€æŸ¥æ¨¡å‹æ¶æ„ä¸æƒé‡æ–‡ä»¶åŒ¹é… |

#### E.2 æ€§èƒ½ç›‘æ§æŒ‡æ ‡

```python
# ç³»ç»Ÿç›‘æ§è„šæœ¬
import psutil
import GPUtil

def monitor_system():
    """ç³»ç»Ÿèµ„æºç›‘æ§"""
    # CPUä½¿ç”¨ç‡
    cpu_percent = psutil.cpu_percent(interval=1)
    
    # å†…å­˜ä½¿ç”¨ç‡
    memory = psutil.virtual_memory()
    memory_percent = memory.percent
    
    # GPUä½¿ç”¨ç‡
    gpus = GPUtil.getGPUs()
    gpu_info = []
    for gpu in gpus:
        gpu_info.append({
            'id': gpu.id,
            'name': gpu.name,
            'load': gpu.load * 100,
            'memory_used': gpu.memoryUsed,
            'memory_total': gpu.memoryTotal,
            'temperature': gpu.temperature
        })
    
    return {
        'cpu_percent': cpu_percent,
        'memory_percent': memory_percent,
        'gpu_info': gpu_info
    }
```

---

## è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®å’Œç¤¾åŒºçš„è´¡çŒ®ï¼š

- **PyTorchå›¢é˜Ÿ**ï¼šæä¾›äº†å¼ºå¤§çš„æ·±åº¦å­¦ä¹ æ¡†æ¶
- **torchvisionç¤¾åŒº**ï¼šä¸°å¯Œçš„é¢„è®­ç»ƒæ¨¡å‹å’Œæ•°æ®å¢å¼ºå·¥å…·
- **Flaskç¤¾åŒº**ï¼šè½»é‡çº§Webæ¡†æ¶æ”¯æŒ
- **å¼€æºæ•°æ®é›†è´¡çŒ®è€…**ï¼šä¸ºé¡¹ç›®æä¾›äº†å®è´µçš„è®­ç»ƒæ•°æ®
- **æ·±åº¦å­¦ä¹ ç ”ç©¶ç¤¾åŒº**ï¼šä¸ºæŠ€æœ¯å‘å±•æä¾›äº†ç†è®ºåŸºç¡€

ç‰¹åˆ«æ„Ÿè°¢æ‰€æœ‰å‚ä¸Frescoé¡¹ç›®å¼€å‘ã€æµ‹è¯•å’Œä¼˜åŒ–çš„å›¢é˜Ÿæˆå‘˜ï¼Œä»¥åŠä¸ºé¡¹ç›®æ”¹è¿›æå‡ºå®è´µå»ºè®®çš„ç”¨æˆ·å’Œå¼€å‘è€…ã€‚

---

## å‚è€ƒæ–‡çŒ®

1. He, K., Zhang, X., Ren, S., & Sun, J. (2016). Deep residual learning for image recognition. CVPR.
2. Vaswani, A., et al. (2017). Attention is all you need. NIPS.
3. Howard, J., & Gugger, S. (2020). Fastai: A layered API for deep learning. Information.
4. Paszke, A., et al. (2019). PyTorch: An imperative style, high-performance deep learning library. NeurIPS.
5. Smith, L. N. (2017). Cyclical learning rates for training neural networks. WACV.
6. Micikevicius, P., et al. (2017). Mixed precision training. ICLR.
7. Szegedy, C., et al. (2016). Rethinking the inception architecture for computer vision. CVPR.
8. DeVries, T., & Taylor, G. W. (2017). Improved regularization of convolutional neural networks with cutout. arXiv preprint.

---

*æ–‡æ¡£ç‰ˆæœ¬ï¼šv2.0*  
*æœ€åæ›´æ–°ï¼š2025å¹´6æœˆ22æ—¥*  
*ä½œè€…ï¼šFrescoå¼€å‘å›¢é˜Ÿ*  
*æ–‡æ¡£å¤§å°ï¼šçº¦30,000å­—*  
*è®¸å¯è¯ï¼šMIT License*
