# 🍎 Fresco 水果蔬菜分类 Web 应用

一个基于深度学习的水果蔬菜图像分类 Web 应用程序，支持批量处理图片并实时显示分类结果。采用现代化的响应式设计，提供友好的用户交互体验。

## ✨ 功能特点

- �️ **拖拽上传** - 支持拖拽文件到页面进行上传
- 📁 **批量处理** - 支持同时上传多个图片文件
- 📦 **ZIP 支持** - 支持上传 ZIP 压缩包，自动递归查找所有图片
- 🎯 **智能识别** - 显示 Top 5 预测结果和置信度
- 📱 **响应式设计** - 完美适配桌面端和移动设备
- ⚡ **实时处理** - 异步处理，无需等待页面刷新
- 🎨 **现代化UI** - 采用渐变色彩和流畅动画效果
- 🔍 **详细结果** - 每张图片显示完整的分类概率分布

## 🚀 快速开始

### 1. 环境要求

- Python 3.8 或更高版本
- 推荐使用虚拟环境

### 2. 安装依赖

```bash
# 进入 web 目录
cd web

# 安装依赖包
pip install -r requirements.txt
```

### 3. 模型文件准备

确保以下任一路径存在训练好的模型文件：
```
../train_v3/optimized_model.pth
../best_model.pth
```

> 💡 应用会自动查找可用的模型文件，优先使用 `train_v3/optimized_model.pth`

### 4. 启动 Web 服务器

#### 方法一：使用启动脚本（推荐）
```bash
# Linux/Mac 用户
./start.sh

# Windows 用户
python app.py
```

#### 方法二：直接运行
```bash
python app.py
```

### 5. 访问应用

打开浏览器访问：http://localhost:5000

## 📖 使用指南

### 🖼️ 图片上传方式

#### 方法一：点击上传
1. 点击页面中心的上传区域
2. 在文件选择对话框中选择图片文件
3. 支持多选，可一次选择多张图片
4. 应用将自动开始处理

#### 方法二：拖拽上传
1. 直接将图片文件拖拽到上传区域
2. 支持同时拖拽多个文件
3. 松开鼠标后自动开始处理

#### 方法三：ZIP 批量上传
1. 将多张图片打包成 ZIP 文件
2. 上传 ZIP 文件到应用
3. 应用会自动解压并递归查找所有图片
4. 支持嵌套文件夹结构

### 📊 结果展示

- **最佳匹配**：置信度最高的预测结果会有特殊的皇冠标识
- **Top 5 预测**：每张图片显示前5个最可能的分类结果
- **置信度**：以百分比形式显示模型的预测信心
- **文件名**：显示原始文件名，便于识别

## 🎨 界面特性

- **现代化设计**：采用渐变色彩和卡片式布局
- **流畅动画**：鼠标悬停和操作都有平滑的过渡效果
- **响应式布局**：自动适配不同屏幕尺寸
- **视觉反馈**：清晰的操作状态提示和结果展示
- **色彩编码**：不同类型的信息使用不同颜色区分

## 📋 支持的文件格式

### 图片格式
- PNG (.png)
- JPEG (.jpg, .jpeg)
- GIF (.gif)
- BMP (.bmp)
- TIFF (.tiff)
- WebP (.webp)

### 压缩包格式
- ZIP (.zip)

### 文件大小限制
- 单个文件：最大 50MB
- 图片文件：建议每张不超过 10MB
- ZIP 文件：最大 50MB（解压后的总大小）

## 🍊 识别类别

应用支持识别以下 36 种水果和蔬菜：

### 🍎 水果类 (13种)
- apple (苹果)
- banana (香蕉) 
- grapes (葡萄)
- kiwi (猕猴桃)
- lemon (柠檬)
- mango (芒果)
- orange (橙子)
- pear (梨)
- pineapple (菠萝)
- pomegranate (石榴)
- watermelon (西瓜)

### 🥬 蔬菜类 (23种)
- beetroot (甜菜根)
- bell pepper (甜椒)
- cabbage (卷心菜)
- capsicum (辣椒)
- carrot (胡萝卜)
- cauliflower (花椰菜)
- chilli pepper (辣椒)
- corn (玉米)
- cucumber (黄瓜)
- eggplant (茄子)
- garlic (大蒜)
- ginger (生姜)
- jalepeno (墨西哥辣椒)
- lettuce (生菜)
- onion (洋葱)
- paprika (红椒粉)
- peas (豌豆)
- potato (土豆)
- raddish (萝卜)
- soy beans (大豆)
- spinach (菠菜)
- sweetcorn (甜玉米)
- sweetpotato (红薯)
- tomato (番茄)
- turnip (芜菁)

## 🔧 技术架构

### 后端技术
- **Web 框架**：Flask 2.0+
- **深度学习**：PyTorch 2.0+
- **图像处理**：PIL (Pillow)
- **模型架构**：基于 ResNet50 的优化 CNN
- **文件处理**：Python 标准库

### 前端技术
- **页面结构**：HTML5 语义化标签
- **样式设计**：CSS3 + 现代化动画效果
- **交互逻辑**：原生 JavaScript (ES6+)
- **文件处理**：FormData API + Fetch API
- **拖拽支持**：HTML5 Drag and Drop API

### 核心特性
- **异步处理**：非阻塞的文件上传和处理
- **内存优化**：临时文件自动清理
- **错误处理**：完善的异常捕获和用户提示
- **安全机制**：文件类型检查和大小限制
- **JIT 优化**：模型推理性能优化

## ⚡ 性能优化

### 模型加载优化
- 自动检测可用的模型文件
- 支持 CPU 和 GPU 推理
- 使用 JIT 编译加速推理
- 模型权重缓存避免重复加载

### 文件处理优化
- 临时文件自动清理机制
- 内存友好的大文件处理
- 并发安全的文件操作
- 智能的 ZIP 文件解压

### 前端性能
- 图片 base64 编码传输
- 异步加载避免页面阻塞
- CSS 动画硬件加速
- 响应式图片显示

## 🛠️ 故障排除

### 常见问题

**❓ 模型加载失败**
```
解决方案：
1. 检查模型文件路径是否正确
2. 确认模型文件完整性
3. 检查 Python 路径配置
```

**❓ 图片上传失败**
```
解决方案：
1. 检查文件格式是否支持
2. 确认文件大小是否超限
3. 检查网络连接状态
```

**❓ 预测结果异常**
```
解决方案：
1. 确认图片质量和清晰度
2. 检查图片内容是否为支持的类别
3. 尝试调整图片尺寸或格式
```

**❓ 页面加载缓慢**
```
解决方案：
1. 减少单次上传的文件数量
2. 优化图片文件大小
3. 检查服务器性能
```

### 调试模式

启动调试模式以获取详细日志：
```bash
# 在 app.py 中修改
app.run(debug=True, host="0.0.0.0", port=5000)
```

## 📞 技术支持

如果在使用过程中遇到问题，请：

1. 检查控制台输出的错误信息
2. 确认依赖包版本是否匹配
3. 验证模型文件是否正确加载
4. 查看浏览器开发者工具的网络请求

## 🔄 版本更新

### v1.0.0 (当前版本)
- ✅ 基础图片分类功能
- ✅ 批量文件处理
- ✅ ZIP 文件支持
- ✅ 响应式 UI 设计
- ✅ 实时结果展示
